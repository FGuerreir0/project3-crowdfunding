{"ast":null,"code":"import _defineProperty from\"/Users/fguerreir0/ironhack/projects/project3-crowdfunding/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/fguerreir0/ironhack/projects/project3-crowdfunding/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/fguerreir0/ironhack/projects/project3-crowdfunding/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/fguerreir0/ironhack/projects/project3-crowdfunding/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/fguerreir0/ironhack/projects/project3-crowdfunding/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'./styles.scss';import{createContribution}from'./../../services/contributePayment';import{loadStripe}from'@stripe/stripe-js';import{CardElement,Elements,ElementsConsumer}from'@stripe/react-stripe-js';var STRIPE_PUBLIC_API_KEY=process.env.REACT_APP_STRIPE_API_PUBLIC_KEY;var ContributeMoneyView=/*#__PURE__*/function(_Component){_inherits(ContributeMoneyView,_Component);var _super=_createSuper(ContributeMoneyView);function ContributeMoneyView(props){var _this;_classCallCheck(this,ContributeMoneyView);_this=_super.call(this,props);_this.handleInputChange=function(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;_this.setState(_defineProperty({},name,value));};_this.handleFormSubmission=function(event,stripe,elements){event.preventDefault();stripe.createPaymentMethod({type:'card',card:elements.getElement(CardElement)}).then(function(data){if(data.error){return Promise.reject(data.error);}else{var userId=_this.props.user._id;var supporting=_this.props.match.params.project_id;var amount=_this.state.contribution;var creditCardToken=data.paymentMethod.id;return createContribution({userId:userId,supporting:supporting,amount:amount,creditCardToken:creditCardToken});}}).then(function(){_this.props.history.push(\"/project/\".concat(_this.props.match.params.project_id));}).catch(function(error){console.log(error);});};_this.state={contribution:0};_this.stripePromise=loadStripe(STRIPE_PUBLIC_API_KEY);return _this;}_createClass(ContributeMoneyView,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",{className:\"mt-12 text-center\"},/*#__PURE__*/React.createElement(Elements,{stripe:this.stripePromise},/*#__PURE__*/React.createElement(ElementsConsumer,null,function(_ref){var stripe=_ref.stripe,elements=_ref.elements;return/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(event){return _this2.handleFormSubmission(event,stripe,elements);}},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"contribution\"},\"Contribution: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"number\",name:\"contribution\",id:\"contribution\",value:_this2.state.contribution,onChange:_this2.handleInputChange,style:{textAlign:'right',width:'80px'}}),/*#__PURE__*/React.createElement(\"label\",null,\"\\u20AC\"),/*#__PURE__*/React.createElement(CardElement,{option:{style:{base:{fontSize:'50px',color:'#424770',fontFamily:'sans-serif'},invalid:{color:'#c23d4b'}}}}),/*#__PURE__*/React.createElement(\"button\",{className:\"text-center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 border border-blue-700 rounded\"},\"Confirm Contribution\"));})));}}]);return ContributeMoneyView;}(Component);export default ContributeMoneyView;","map":{"version":3,"sources":["/Users/fguerreir0/ironhack/projects/project3-crowdfunding/client/src/views/ContributeMoney/index.jsx"],"names":["React","Component","createContribution","loadStripe","CardElement","Elements","ElementsConsumer","STRIPE_PUBLIC_API_KEY","process","env","REACT_APP_STRIPE_API_PUBLIC_KEY","ContributeMoneyView","props","handleInputChange","event","target","name","value","setState","handleFormSubmission","stripe","elements","preventDefault","createPaymentMethod","type","card","getElement","then","data","error","Promise","reject","userId","user","_id","supporting","match","params","project_id","amount","state","contribution","creditCardToken","paymentMethod","id","history","push","catch","console","log","stripePromise","textAlign","width","style","base","fontSize","color","fontFamily","invalid"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './styles.scss';\nimport { createContribution } from './../../services/contributePayment';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { CardElement, Elements, ElementsConsumer } from '@stripe/react-stripe-js';\n\nconst STRIPE_PUBLIC_API_KEY = process.env.REACT_APP_STRIPE_API_PUBLIC_KEY;\n\nclass ContributeMoneyView extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      contribution: 0\n    };\n\n    this.stripePromise = loadStripe(STRIPE_PUBLIC_API_KEY);\n  }\n\n  handleInputChange = (event) => {\n    const { name, value } = event.target;\n    this.setState({\n      [name]: value\n    });\n  };\n\n  handleFormSubmission = (event, stripe, elements) => {\n    event.preventDefault();\n\n    stripe\n      .createPaymentMethod({\n        type: 'card',\n        card: elements.getElement(CardElement)\n      })\n      .then((data) => {\n        if (data.error) {\n          return Promise.reject(data.error);\n        } else {\n          const userId = this.props.user._id;\n          const supporting = this.props.match.params.project_id;\n          const amount = this.state.contribution;\n          const creditCardToken = data.paymentMethod.id;\n          return createContribution({ userId, supporting, amount, creditCardToken });\n        }\n      })\n      .then(() => {\n        this.props.history.push(`/project/${this.props.match.params.project_id}`);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  render() {\n    return (\n      <div className='mt-12 text-center'>\n        <Elements stripe={this.stripePromise}>\n          <ElementsConsumer>\n            {({ stripe, elements }) => (\n              <form onSubmit={(event) => this.handleFormSubmission(event, stripe, elements)}>\n                <label htmlFor='contribution'>Contribution: </label>\n                <input\n                  type='number'\n                  name='contribution'\n                  id='contribution'\n                  value={this.state.contribution}\n                  onChange={this.handleInputChange}\n                  style={{ textAlign: 'right', width: '80px' }}\n                ></input>\n                <label>â‚¬</label>\n\n                <CardElement\n                  option={{\n                    style: {\n                      base: {\n                        fontSize: '50px',\n                        color: '#424770',\n                        fontFamily: 'sans-serif'\n                      },\n                      invalid: {\n                        color: '#c23d4b'\n                      }\n                    }\n                  }}\n                />\n\n                <button className='text-center bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 border border-blue-700 rounded'>\n                  Confirm Contribution\n                </button>\n              </form>\n            )}\n          </ElementsConsumer>\n        </Elements>\n      </div>\n    );\n  }\n}\n\nexport default ContributeMoneyView;\n"]},"metadata":{},"sourceType":"module"}